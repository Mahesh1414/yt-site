<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Youtube Video Downloader</title>
    <style>
        h3{
            text-align: center;
        }
        h1{
            text-align: center;
        }
        form{
            text-align: center;
        }
        input{
            width: 10cm;
            border-color: black;
            border-radius: 10cm;
            height: 0.85cm;
            text-align: center;

        }
        button{
            color: white;
            background-color: rgb(0, 94, 255);
            border-color: black;
            border-radius: 10cm;
            width: 5cm;
            height: 1cm;
            text-align: center;
            font-size: larger;
            font-family: Arial, Helvetica, sans-serif;
            font-style: normal;
            font-weight: 500;
            text-align: center;
        }
        div.about{
            text-align: center;
            border-color: #000000;
            border-width: 10cm;
        }
        div.quick{
            text-align: center;
            border: 10px 10px;
            border-style: double;

        }
        h2.head_about{
            font-size: xx-large;
        }
        h3.quick_easy{
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
        }
        p.quick_para{
            font-size: x-large;
            text-align: center;
        }

        
    </style>
</head>
<body>
    <h3>This is the best way to download videos from youtube to your local storage</h3>
    <br><br>
    <h1>Youtube Video Downloader</h1>
    <div id="form1">
    <form method="post" name="link-form" onsubmit="return main(event)">
    <input type="url" name="url" id="link-text" required>
    <br><br>
    <button type="submit">Fetch Details</button>
    </form>
    </div>

    <div  style="display: none; opacity: 0;" id="form2" >
    </div>

    <div  style="display: none; opacity: 0;" id="form3" >
    </div>

    <br><br>
    <div class="about">
        <h2 class="head_about">About Our Service</h2>
        <div class="quick">
            <svg id="Flat" height="auto" viewBox="0 0 512 512" width="auto" xmlns="http://www.w3.org/2000/svg"><circle cx="312" cy="256" fill="#e9eef2" r="152"/><g fill="#ffe76c"><path d="m192 376h-112a8 8 0 0 1 0-16h112a8 8 0 0 1 0 16z"/><path d="m48 376h-8a8 8 0 0 1 0-16h8a8 8 0 0 1 0 16z"/><path d="m320 432h-192a8 8 0 0 1 0-16h192a8 8 0 0 1 0 16z"/><path d="m96 432h-64a8 8 0 0 1 0-16h64a8 8 0 0 1 0 16z"/><path d="m144 224h-48a8 8 0 0 1 0-16h48a8 8 0 0 1 0 16z"/><path d="m144 304h-48a8 8 0 0 1 0-16h48a8 8 0 0 1 0 16z"/><path d="m80 264h-48a8 8 0 0 1 0-16h48a8 8 0 0 1 0 16z"/><path d="m192 152h-112a8 8 0 0 1 0-16h112a8 8 0 0 1 0 16z"/><path d="m48 152h-8a8 8 0 0 1 0-16h8a8 8 0 0 1 0 16z"/><path d="m320 96h-192a8 8 0 0 1 0-16h192a8 8 0 0 1 0 16z"/><path d="m96 96h-64a8 8 0 0 1 0-16h64a8 8 0 0 1 0 16z"/></g><path d="m312 136a8 8 0 0 1 -8-8v-16a8 8 0 0 1 16 0v16a8 8 0 0 1 -8 8z" fill="#9aa3a8"/><path d="m312 408a8 8 0 0 1 -8-8v-16a8 8 0 0 1 16 0v16a8 8 0 0 1 -8 8z" fill="#9aa3a8"/><path d="m456 264h-16a8 8 0 0 1 0-16h16a8 8 0 0 1 0 16z" fill="#9aa3a8"/><path d="m184 264h-16a8 8 0 0 1 0-16h16a8 8 0 0 1 0 16z" fill="#9aa3a8"/><path d="m413.823 365.823a7.976 7.976 0 0 1 -5.657-2.343l-11.313-11.313a8 8 0 0 1 11.314-11.314l11.313 11.314a8 8 0 0 1 -5.657 13.656z" fill="#9aa3a8"/><path d="m221.49 173.49a7.976 7.976 0 0 1 -5.657-2.343l-11.313-11.314a8 8 0 0 1 11.314-11.313l11.313 11.313a8 8 0 0 1 -5.657 13.657z" fill="#9aa3a8"/><path d="m402.51 173.49a8 8 0 0 1 -5.657-13.657l11.313-11.313a8 8 0 0 1 11.314 11.313l-11.313 11.314a7.976 7.976 0 0 1 -5.657 2.343z" fill="#9aa3a8"/><path d="m210.177 365.823a8 8 0 0 1 -5.657-13.656l11.313-11.314a8 8 0 1 1 11.314 11.314l-11.313 11.313a7.976 7.976 0 0 1 -5.657 2.343z" fill="#9aa3a8"/><path d="m413.657 250.343-16-16a8 8 0 0 0 -11.314 11.314l2.343 2.343h-68.686v-52.686l2.343 2.343a8 8 0 1 0 11.314-11.314l-16-16a8 8 0 0 0 -11.314 0l-16 16a8 8 0 0 0 11.314 11.314l2.343-2.343v60.686a8 8 0 0 0 8 8h76.686l-2.343 2.343a8 8 0 0 0 11.314 11.314l16-16a8 8 0 0 0 0-11.314z" fill="#9aa3a8"/><circle cx="312" cy="256" fill="#ffb632" r="16"/><path d="m312 80a176 176 0 1 0 176 176 176 176 0 0 0 -176-176zm0 320a144 144 0 1 1 144-144 144 144 0 0 1 -144 144z" fill="#ffb632"/></svg>
            <h3 class="qucik_easy" style="font-size: x-large;">Quick and Easy to Use</h3>
            <p class="quick_para">
                This is the fastest YouTube Video Downloader site. This site is very simple to use and quick. All you have to do is give us the video URL, select the resolution and hit the download button!
            </p>
            
            <svg id="Capa_1" enable-background="new 0 0 512 512" height="auto" viewBox="0 0 512 512" width="auto" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="256" x2="256" y1="512" y2="0"><stop offset="0" stop-color="#00b59c"/><stop offset="1" stop-color="#9cffac"/></linearGradient><linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="256" x2="256" y1="361" y2="151"><stop offset="0" stop-color="#c3ffe8"/><stop offset=".9973" stop-color="#f0fff4"/></linearGradient><g><g><g><path d="m436 81.621c-83.027 0-169.071-76.961-169.923-77.732-5.719-5.185-14.436-5.185-20.154 0-.857.777-86.675 77.732-169.923 77.732-8.284 0-15 6.716-15 15v179.638c0 145.524 108.236 203.674 189.65 234.755 1.723.658 3.536.986 5.35.986s3.627-.329 5.35-.986c114.154-43.58 189.65-111.559 189.65-234.755v-179.638c0-8.284-6.716-15-15-15z" fill="url(#SVGID_1_)"/></g></g><g><g><path d="m256 151c-57.897 0-105 47.103-105 105s47.103 105 105 105 105-47.103 105-105-47.103-105-105-105zm40.606 100.606-45 45c-2.928 2.929-6.767 4.394-10.606 4.394s-7.678-1.464-10.606-4.394l-15-15c-5.858-5.858-5.858-15.355 0-21.213 5.857-5.858 15.355-5.858 21.213 0l4.394 4.393 34.394-34.393c5.857-5.858 15.355-5.858 21.213 0 5.857 5.858 5.857 15.355-.002 21.213z" fill="url(#SVGID_2_)"/></g></g></g></svg>
            <h3 class="quick_easy" style="font-size: x-large;">Completely Risk-free</h3>
            <p class="quick_para">
                It's understandle that you might not feel completely safe downloading files from a foreign websites. But we offer you a 100% smooth and secure experience!
            </p>
        </div>
    </div>
</body>
<script>
var form1 = document.getElementById("form1");
var form2 = document.getElementById("form2");
var form3 = document.getElementById("form3");
var id    = null

function callbk(d){
[i,t,p] = d.split("|");

fetch("/down", { method: 'POST', headers: new Headers({'Content-Type': 'application/json'}),
       body: JSON.stringify({id:id, progressive:p, mtype:t, vtag:i, atag:false}) })
      .then(response => response.json())
      .then(data => final(data))
      .catch(error => console.error('Error!', error.message))

}

function final(data){
   form2.style.display = "none";
   form2.style.opacity = 0;
   form3.style.display = "block";
   form3.style.opacity = 1;
   p = document.createElement("p");
   p.innerHTML = `<a href="/final/${id}"><button>Download</button></a>`
   form3.appendChild(p)
}

function done(data){
   form1.style.display = "none";
   form1.style.opacity = 0;
   form2.style.display = "block";
   form2.style.opacity = 1;
   //id should be sent with every request
   //or server will deny
   id = data.id
   msg = data.msg
   img = document.createElement("img");
   img.src = data.thumb
   img.alt = msg.title
   vid     = data.buttonsV 
   aud     = data.buttonsA

   p = document.createElement("p");
   f = `<b>Title:</b> ${msg.title}<br><b>Artist: <a href="${msg.channel}">${msg.artist}</a></b><br><b>Length:</b> ${msg.length}<br><b>Views:</b> ${msg.hits}<br><b>Date:</b> ${msg.udate}<br>`;
   p.innerHTML = f;

   p2 = document.createElement("p");
   for (i in vid){ 
   p2.innerHTML += `<button onclick="callbk('${vid[i].callbk}')">${vid[i].tex}</button>`}

   p3 = document.createElement("p");
   for (i in aud){
   p3.innerHTML += `<button onclick="callbk('${aud[i].callbk}')">${aud[i].tex}</button>`}


   form2.appendChild(img)
   form2.appendChild(p)
   form2.appendChild(p2)
   form2.appendChild(p3)

   alert(msg.title);
}


function handledd(data){
console.log(data);
if (data.status == "info"){done(data)}

else if (data.status == "final"){final(data)}

else if (data.status == "error"){
      alert(data.msg);
      location.reload();}

else{alert("Please Enter a valid Youtube/Youtube Music link"); location.reload();}

}

async function main(e){
e.preventDefault();
var link  = document.getElementById("link-text");
if (link.value < 5){alert("Please Enter a valid Youtube/Youtube Music link"); e.preventDefault(); return}

fetch("/fetch_url", { method: 'POST', headers: new Headers({'Content-Type': 'application/x-www-form-urlencoded'}), body: 'link='+link.value})
      .then(response => response.json())
      .then(data => handledd(data))
      .catch(error => console.error('Error!', error.message))

return}
</script>
</html>
